package DATA;

CREATE DATABASE PCStore CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE PCStore;

-- Create ChucNang table
CREATE TABLE IF NOT EXISTS ChucNang (
    idChucNang VARCHAR(20) PRIMARY KEY,
    tenChucNang VARCHAR(50) NOT NULL
);

-- Create Quyen table
CREATE TABLE IF NOT EXISTS NhomQuyen (
    idNhomQuyen VARCHAR(20) PRIMARY KEY,
    tenNhomQuyen VARCHAR(50) NOT NULL
);

-- Create PhanQuyen table
CREATE TABLE IF NOT EXISTS ChiTietQuyen (
    idNhomQuyen VARCHAR(20) PRIMARY KEY,
    idChucNang VARCHAR(50) NOT NULL,
    hanhDong VARCHAR(5) NOT NULL,
    FOREIGN KEY (idNhomQuyen) REFERENCES NhomQuyen(idNhomQuyen),
    FOREIGN KEY (idChucNang) REFERENCES ChucNang(idChucNang)
);

-- Create DanhMuc table
CREATE TABLE IF NOT EXISTS DanhMuc (
    idDanhMuc VARCHAR(20) PRIMARY KEY,
    tenDanhMuc VARCHAR(50) NOT NULL
);

-- Create DanhMucCon table
CREATE TABLE IF NOT EXISTS DanhMucCon (
    idDanhMucCon VARCHAR(20) PRIMARY KEY,
    idDanhMuc VARCHAR(20) NOT NULL,
    tenLoai VARCHAR(50) NOT NULL,
    FOREIGN KEY (idDanhMuc) REFERENCES DanhMuc(idDanhMuc)
);

-- Create ThuongHieu table
CREATE TABLE IF NOT EXISTS ThuongHieu (
    idThuongHieu VARCHAR(20) PRIMARY KEY,
    tenThuongHieu VARCHAR(50) NOT NULL
);

-- Create NhaCungCap table
CREATE TABLE IF NOT EXISTS NhaCungCap (
    idNhaCungCap VARCHAR(20) PRIMARY KEY,
    tenNhaCungCap VARCHAR(255) NOT NULL,
    diaChi VARCHAR(500),
    soDienThoai VARCHAR(20),
    email VARCHAR(255)
);

-- Create SanPham table
CREATE TABLE IF NOT EXISTS SanPham (
    idSanPham VARCHAR(20) PRIMARY KEY,
    idDanhMucCon VARCHAR(20) NOT NULL,
    tenSanPham VARCHAR(255) NOT NULL,
    idThuongHieu VARCHAR(20) NOT NULL,
    gia INT NOT NULL,
    moTaSanPham VARCHAR(1000),
    anhSanPham BLOB,
    FOREIGN KEY (idDanhMucCon) REFERENCES DanhMucCon(idDanhMucCon),
    FOREIGN KEY (idThuongHieu) REFERENCES ThuongHieu(idThuongHieu)
);

-- Create ThongTinKyThuat table
CREATE TABLE IF NOT EXISTS ThongTinKyThuat (
	idThongTin VARCHAR(20) PRIMARY KEY,
    tenThongTIn VARCHAR(50) NOT NULL
);

-- Create CauHinhPC
CREATE TABLE IF NOT EXISTS CauHinhPC (
	idSanPham VARCHAR(20),
    idThongTin VARCHAR(20),
    idLinkKien VARCHAR(20),
    FOREIGN KEY (idSanPham) REFERENCES SanPham(idSanPham),
    FOREIGN KEY (idThongTin) REFERENCES ThongTinKyThuat(idThongTin)
);

-- Create Ghep table
CREATE TABLE IF NOT EXISTS Ghep (
    idSanPhamGhep VARCHAR(20) NOT NULL,
    idSanPham VARCHAR(20) NOT NULL,
    FOREIGN KEY (idSanPhamGhep) REFERENCES SanPham(idSanPham),
    FOREIGN KEY (idSanPham) REFERENCES SanPham(idSanPham)
);

-- Create KhuyenMai table
CREATE TABLE IF NOT EXISTS KhuyenMai (
    idKhuyenMai VARCHAR(20) PRIMARY KEY,
    giaTri DECIMAL(10,2) NOT NULL
);

-- Create KhuyenMaiCombo table
CREATE TABLE IF NOT EXISTS KhuyenMaiCombo (
    idKhuyenMai VARCHAR(20) NOT NULL,
    idSanPham VARCHAR(20) NOT NULL,
    FOREIGN KEY (idKhuyenMai) REFERENCES KhuyenMai(idKhuyenMai),
    FOREIGN KEY (idSanPham) REFERENCES SanPham(idSanPham)
);

-- Create NhanVien table
CREATE TABLE IF NOT EXISTS NhanVien (
    idNhanVien VARCHAR(20) PRIMARY KEY,
    hoNhanVien VARCHAR(20) NOT NULL,
    tenNhanVien VARCHAR(50) NOT NULL,
    ngaySinh DATE,
    soDienThoai VARCHAR(20),
    email VARCHAR(255),
    ngayVaoLam DATE,
    chucVu VARCHAR(50),
    luong DECIMAL(10,2),
    diaChi VARCHAR(500),
    anhDaiDien BLOB
);

-- Create TaiKhoan table
CREATE TABLE IF NOT EXISTS TaiKhoan (
	idTaiKhoan VARCHAR(20) PRIMARY KEY,
    idNhanVien VARCHAR(20) NOT NULL,
    idNhomQuyen VARCHAR(20) NOT NULL,
    matKhau VARCHAR(50) NOT NULL,
    FOREIGN KEY (idNhomQuyen) REFERENCES NhomQuyen(idNhomQuyen),
    FOREIGN KEY (idNhanVien) REFERENCES NhanVien(idNhanVien)
);

-- Create KhachHang table
CREATE TABLE IF NOT EXISTS KhachHang (
    idKhachHang VARCHAR(20) PRIMARY KEY,
    hoKhachHang VARCHAR(255) NOT NULL,
    tenKhachHang VARCHAR(255) NOT NULL,
    soDienThoai VARCHAR(20),
    ngaySinh DATE
);

-- Create HoaDonXuat table
CREATE TABLE IF NOT EXISTS HoaDonXuat (
    idHoaDonXuat VARCHAR(20) PRIMARY KEY,
    idNhanVien VARCHAR(20) NOT NULL,
    idKhachHang VARCHAR(20) NOT NULL,
    ngayTao DATE NOT NULL,
    tongTien DECIMAL(10,2) NOT NULL,
    idKhuyenMai VARCHAR(20),
    FOREIGN KEY (idNhanVien) REFERENCES NhanVien(idNhanVien),
    FOREIGN KEY (idKhachHang) REFERENCES KhachHang(idKhachHang),
    FOREIGN KEY (idKhuyenMai) REFERENCES KhuyenMai(idKhuyenMai)
);

-- Create ChiTietHoaDonXuat table
CREATE TABLE IF NOT EXISTS ChiTietHoaDonXuat (
    idChiTietHoaDonXuat VARCHAR(20) PRIMARY KEY,
    idHoaDonXuat VARCHAR(20) NOT NULL,
    idSanPham VARCHAR(20) NOT NULL,
    soLuong INT NOT NULL,
    thanhTien DECIMAL(10,2) NOT NULL,
    FOREIGN KEY (idHoaDonXuat) REFERENCES HoaDonXuat(idHoaDonXuat),
    FOREIGN KEY (idSanPham) REFERENCES SanPham(idSanPham)
);

-- Create HoaDonNhap table
CREATE TABLE IF NOT EXISTS HoaDonNhap (
    idHoaDonNhap VARCHAR(20) PRIMARY KEY,
    idNhanVien VARCHAR(20) NOT NULL,
    idNhaCungCap VARCHAR(20) NOT NULL,
    ngayTao DATE NOT NULL,
    tongTien DECIMAL(10,2) NOT NULL,
    FOREIGN KEY (idNhanVien) REFERENCES NhanVien(idNhanVien),
    FOREIGN KEY (idNhaCungCap) REFERENCES NhaCungCap(idNhaCungCap)
);

-- Create ChiTietHoaDonNhap table
CREATE TABLE IF NOT EXISTS ChiTietHoaDonNhap (
    idChiTietHoaDonNhap VARCHAR(20) PRIMARY KEY,
    idHoaDonNhap VARCHAR(20) NOT NULL,
    idSanPham VARCHAR(20) NOT NULL,
    soLuong INT NOT NULL,
    thanhTien DECIMAL(10,2) NOT NULL,
    FOREIGN KEY (idHoaDonNhap) REFERENCES HoaDonNhap(idHoaDonNhap),
    FOREIGN KEY (idSanPham) REFERENCES SanPham(idSanPham)
);